
    @font-face { font-family:'GoogleSans'; src:url('GoogleSans-Regular.ttf') format('truetype'); font-weight:400; }
    @font-face { font-family:'GoogleSans'; src:url('GoogleSans-Bold.ttf')    format('truetype'); font-weight:700; }
    @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

    /* ── TOKENS: LIGHT (default) ── */
    :root {
      --bg:       #f5f5f5;
      --panel:    #ffffff;
      --border:   #e2e2e2;
      --border2:  #d0d0d0;
      --dim:      #c0c0c0;
      --muted:    #999;
      --white:    #1a1a1a;
      --red:      #e8002d;
      --red-dim:  rgba(232,0,45,0.07);
      --feed-bg:  #fafafa;
      --code-bg:  #f0f0f0;
      --shadow:   0 1px 4px rgba(0,0,0,.08);
    }

    /* ── TOKENS: DARK ── */
    body.dark {
      --bg:      #050505;
      --panel:   #0a0a0a;
      --border:  #1a1a1a;
      --border2: #2a2a2a;
      --dim:     #333;
      --muted:   #666;
      --white:   #f0f0f0;
      --red:     #ff0033;
      --red-dim: rgba(255,0,51,0.08);
      --feed-bg: #060606;
      --code-bg: #060606;
      --shadow:  none;
    }

    * { margin:0; padding:0; box-sizing:border-box; }
    html, body { height:100%; overflow:hidden; background:var(--bg); color:var(--white); font-family:'GoogleSans',sans-serif; transition:background .25s,color .25s; }

    /* ── NAV ── */
    nav {
      height:52px; display:flex; align-items:center; justify-content:space-between;
      padding:0 22px; background:var(--panel); border-bottom:1px solid var(--border);
      box-shadow:var(--shadow); z-index:100; position:relative;
    }
    .logo       { font-family:'Fira Code',monospace; font-size:1.25rem; font-weight:700; color:var(--white); }
    .logo span  { color:var(--red); }
    .nav-right  { display:flex; align-items:center; gap:8px; }
    .nav-folder {
      font-family:'Fira Code',monospace; font-size:.7rem; color:var(--muted);
      border:1px solid var(--border); padding:3px 10px; border-radius:4px;
      max-width:260px; overflow:hidden; text-overflow:ellipsis; white-space:nowrap;
      background:var(--bg);
    }
    .nav-folder i { color:var(--red); margin-right:5px; }

    .nbtn {
      background:transparent; border:1px solid var(--border2); color:var(--muted);
      height:32px; padding:0 12px; border-radius:4px; font-family:'Fira Code',monospace;
      font-size:.72rem; cursor:pointer; transition:all .2s; display:none; white-space:nowrap;
      align-items:center; gap:5px;
    }
    .nbtn:hover { border-color:var(--red); color:var(--red); background:var(--red-dim); }
    #btn-stop       { border-color:var(--red); color:var(--red); }
    #btn-stop:hover { background:var(--red-dim); }

    .icon-btn {
      background:transparent; border:1px solid var(--border2); color:var(--muted);
      width:32px; height:32px; border-radius:4px; font-size:.82rem; cursor:pointer;
      display:flex; align-items:center; justify-content:center; transition:all .2s; flex-shrink:0;
    }
    .icon-btn:hover { border-color:var(--red); color:var(--red); background:var(--red-dim); }

    .lang-switch {
      cursor:pointer; color:var(--muted); font-size:.75rem;
      display:flex; align-items:center; gap:5px; font-family:'Fira Code',monospace;
      border:1px solid var(--border2); height:32px; padding:0 10px; border-radius:4px;
      transition:.3s; background:transparent; white-space:nowrap; flex-shrink:0;
    }
    .lang-switch:hover { color:var(--red); border-color:var(--red); background:var(--red-dim); }

    /* ── PROGRESS BAR ── */
    #pbar-wrap { height:2px; background:var(--border); flex-shrink:0; }
    #pbar { height:100%; background:var(--red); width:0%; transition:width .25s ease; box-shadow:0 0 8px var(--red); }

    /* ── THREE-PANEL LAYOUT ── */
    .app-body   { display:flex; flex-direction:column; height:calc(100vh - 54px); }
    .panels-row { flex:1; display:flex; overflow:hidden; }
    .panel      { display:flex; flex-direction:column; overflow:hidden; min-width:100px; }

    /* ── PANEL HEADER ── */
    .ph {
      height:36px; flex-shrink:0; display:flex; align-items:center; justify-content:space-between;
      padding:0 14px; background:var(--panel); border-bottom:1px solid var(--border);
      font-family:'GoogleSans',sans-serif; font-size:.82rem; font-weight:700; color:var(--white);
    }
    .ph-l       { display:flex; align-items:center; gap:8px; overflow:hidden; }
    .ph-l span  { white-space:nowrap; }
    .ph-sub     { font-family:'Fira Code',monospace; font-size:.58rem; color:var(--muted); font-weight:400; white-space:nowrap; }
    .dot        { width:7px; height:7px; border-radius:50%; flex-shrink:0; }
    .d-idle     { background:var(--dim); }
    .d-run      { background:var(--red); animation:blink 1s infinite; }
    .d-stop     { background:var(--muted); animation:none; }
    @keyframes blink { 0%,100%{opacity:1} 50%{opacity:.15} }
    #scan-lbl   { font-weight:700; }
    .badge      { background:var(--red); color:#fff; border-radius:10px; padding:1px 8px; font-size:.67rem; font-family:'Fira Code',monospace; font-weight:700; flex-shrink:0; }
    .badge.z    { background:var(--dim); color:var(--muted); }

    /* ── RESIZABLE DIVIDERS ── */
    .divider { width:5px; flex-shrink:0; background:transparent; cursor:col-resize; position:relative; z-index:20; transition:background .15s; user-select:none; }
    .divider:hover, .divider.drag { background:var(--red); }
    .divider::after { content:''; position:absolute; top:50%; left:50%; transform:translate(-50%,-50%); width:1px; height:40px; background:var(--border2); }

    /* ── LEFT PANEL: FEED ── */
    #panel-left { width:260px; border-right:1px solid var(--border); }
    #feed       { flex:1; overflow:hidden; padding:8px 12px; font-family:'Fira Code',monospace; font-size:.67rem; line-height:1.8; background:var(--feed-bg); }
    .fl         { white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .fl-dir     { color:var(--white); opacity:.85; }
    .fl-file    { color:var(--muted); }
    .fl-skip    { color:var(--dim); font-style:italic; }
    .fl-match   { color:var(--red); font-weight:700; }
    .fl-info    { color:var(--dim); }
    .fl-ok      { color:var(--white); font-weight:700; }
    .fl-err     { color:var(--red); }

    /* ── MID PANEL: DUPLICATES ── */
    #panel-mid    { flex:1; border-right:1px solid var(--border); }
    /* position:relative is required for VirtualScroller's absolute-positioned children */
    #dupes-scroll { flex:1; overflow-y:auto; position:relative; scrollbar-width:thin; scrollbar-color:var(--red) transparent; }
    #dupes-scroll::-webkit-scrollbar       { width:5px; }
    #dupes-scroll::-webkit-scrollbar-thumb { background:var(--red); border-radius:3px; }

    /* ── VIRTUAL SCROLLER ── */
    #vs-spacer { position:relative; width:100%; min-height:0; }
    .vs-item {
      position:absolute; left:0; right:0; top:0;
      /* GPU-composited moves — no layout reflow */
      will-change:transform;
    }

    /* ── HOME SCREEN ── */
    #home         { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:18px; padding:40px; text-align:center; min-height:100%; }
    .home-icon    { font-size:2.6rem; color:var(--red); opacity:.25; }
    #home h2      { font-size:1.35rem; font-weight:700; color:var(--white); }
    #home p       { color:var(--muted); font-size:.85rem; line-height:1.75; max-width:320px; }
    .home-note    { font-family:'Fira Code',monospace; font-size:.65rem; color:var(--dim); }
    .home-warn    {
      font-family:'Fira Code',monospace; font-size:.63rem; color:var(--red);
      border:1px solid rgba(232,0,45,.3); background:var(--red-dim);
      padding:7px 14px; border-radius:4px; max-width:340px; line-height:1.7;
    }

    .chrome-warn {
      display:flex; align-items:flex-start; gap:11px;
      background:var(--red-dim); border:1px solid rgba(232,0,45,.28);
      border-radius:5px; padding:11px 15px; max-width:360px; text-align:left;
    }
    .chrome-warn i             { color:var(--red); font-size:1rem; flex-shrink:0; margin-top:2px; }
    .chrome-warn-body          { display:flex; flex-direction:column; gap:3px; }
    .chrome-warn-title         { font-size:.78rem; font-weight:700; color:var(--red); font-family:'GoogleSans',sans-serif; }
    .chrome-warn-text          { font-size:.73rem; color:var(--muted); line-height:1.65; }
    .chrome-warn-text strong   { color:var(--white); }

    /* ── FOLDER CONFIRM STEP ── */
    #confirm-step   { display:none; min-height:100%; flex-direction:column; align-items:center; justify-content:center; gap:18px; padding:40px; text-align:center; }
    #confirm-step h3 { font-size:1.1rem; font-weight:700; }
    #confirm-step p  { color:var(--muted); font-size:.83rem; line-height:1.7; max-width:320px; }
    .confirm-path    { font-family:'Fira Code',monospace; font-size:.78rem; color:var(--red); background:var(--red-dim); border:1px solid rgba(232,0,45,.25); padding:8px 16px; border-radius:4px; max-width:380px; word-break:break-all; }
    .confirm-btns    { display:flex; gap:12px; flex-wrap:wrap; justify-content:center; }

    /* ── BUTTONS ── */
    .btn-primary         { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; background:var(--red); border:1px solid var(--red); color:#fff; font-family:'Fira Code',monospace; font-size:.85rem; cursor:pointer; border-radius:4px; transition:all .2s; }
    .btn-primary:hover   { opacity:.88; transform:translateY(-1px); }
    .btn-secondary       { display:inline-flex; align-items:center; gap:8px; padding:10px 20px; background:transparent; border:1px solid var(--border2); color:var(--muted); font-family:'Fira Code',monospace; font-size:.85rem; cursor:pointer; border-radius:4px; transition:all .2s; }
    .btn-secondary:hover { border-color:var(--white); color:var(--white); }

    /* ── DUPLICATE GROUP CARDS ── */
    .dg         { margin:8px 10px; border:1px solid var(--border); border-radius:4px; overflow:hidden; animation:si .25s ease; box-shadow:var(--shadow); }
    @keyframes si { from{opacity:0;transform:translateY(5px)} to{opacity:1;transform:none} }
    .dg-hdr     { background:var(--red-dim); padding:6px 13px; border-bottom:1px solid var(--border); font-family:'Fira Code',monospace; font-size:.68rem; color:var(--muted); display:flex; justify-content:space-between; align-items:center; gap:8px; }
    .dg-hdr .h  { color:var(--red); }
    .dg-hdr .sv { color:var(--white); font-weight:700; white-space:nowrap; }
    .df         { padding:8px 12px; border-bottom:1px solid var(--border); display:flex; align-items:center; gap:9px; transition:background .1s; }
    .df:last-child { border-bottom:none; }
    .df:hover   { background:var(--red-dim); }
    .df.sel     { background:var(--red-dim); border-left:3px solid var(--red); }
    .df.orig    { border-left:3px solid var(--dim); }
    .df input[type=checkbox]          { accent-color:var(--red); width:14px; height:14px; flex-shrink:0; cursor:pointer; }
    .df input[type=checkbox]:disabled { opacity:.25; }
    .df-icon    { font-size:.85rem; color:var(--dim); flex-shrink:0; }
    .df-info    { flex:1; min-width:0; }
    .df-name    { font-size:.83rem; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; color:var(--white); }
    .df-path    { font-size:.63rem; color:var(--muted); font-family:'Fira Code',monospace; white-space:nowrap; overflow:hidden; text-overflow:ellipsis; }
    .orig-tag   { font-size:.58rem; color:var(--red); border:1px solid var(--red); padding:0 4px; border-radius:2px; margin-left:6px; opacity:.6; vertical-align:middle; }
    .btn-eye    { background:transparent; border:1px solid var(--border); color:var(--dim); padding:3px 8px; border-radius:3px; font-size:.7rem; cursor:pointer; transition:all .18s; flex-shrink:0; }
    .btn-eye:hover { border-color:var(--red); color:var(--red); }

    /* ── STATS BAR ── */
    #stats-bar  { min-height:40px; flex-shrink:0; display:flex; align-items:center; flex-wrap:wrap; gap:4px; padding:0 10px; border-top:1px solid var(--border); background:var(--panel); font-family:'Fira Code',monospace; font-size:.68rem; color:var(--muted); box-shadow:var(--shadow); }
    .sbar-left  { display:flex; align-items:center; gap:6px; }
    .sbar-center { flex:1; display:flex; align-items:center; justify-content:center; min-width:0; }
    .sbar-right { display:flex; align-items:center; gap:5px; }
    .sbar-val   { color:var(--white); font-weight:700; }
    .sbar-sep   { color:var(--dim); }
    #sel-info   { display:none; font-family:'Fira Code',monospace; font-size:.68rem; color:var(--red); font-weight:700; }
    .sbar-btn   { background:transparent; border:1px solid var(--border2); color:var(--muted); padding:3px 9px; border-radius:3px; font-family:'Fira Code',monospace; font-size:.64rem; cursor:pointer; transition:all .18s; white-space:nowrap; }
    .sbar-btn:hover { border-color:var(--white); color:var(--white); }
    #btn-del    { background:var(--red); border:1px solid var(--red); color:#fff; padding:3px 10px; border-radius:3px; font-family:'Fira Code',monospace; font-size:.64rem; cursor:pointer; transition:all .18s; display:none; white-space:nowrap; }
    #btn-del:hover { opacity:.85; }

    /* ── RIGHT PANEL: PREVIEW ── */
    #panel-right    { width:290px; }
    #prev-body      { flex:1; overflow:hidden; display:flex; flex-direction:column; }
    #prev-empty     { flex:1; display:flex; flex-direction:column; align-items:center; justify-content:center; gap:10px; color:var(--dim); font-size:.8rem; text-align:center; }
    #prev-empty i   { font-size:2.2rem; }
    #prev-content   { flex:1; overflow-y:auto; padding:14px; display:none; scrollbar-width:thin; scrollbar-color:var(--border2) transparent; }
    #prev-content::-webkit-scrollbar       { width:4px; }
    #prev-content::-webkit-scrollbar-thumb { background:var(--border2); border-radius:2px; }
    .pv-name        { font-size:.9rem; font-weight:700; word-break:break-all; margin-bottom:4px; color:var(--white); }
    .pv-meta        { font-family:'Fira Code',monospace; font-size:.63rem; color:var(--muted); margin-bottom:12px; line-height:1.7; }
    .pv-meta .ac    { color:var(--red); font-weight:700; }
    #btn-close-prev { background:transparent; border:none; color:var(--muted); cursor:pointer; font-size:.78rem; padding:3px 5px; border-radius:3px; transition:color .15s; line-height:1; }
    #btn-close-prev:hover { color:var(--red); }

    /* ── FORMAT FILTER CHIPS ── */
    #filter-bar  { display:none; flex-shrink:0; padding:6px 10px; border-bottom:1px solid var(--border); background:var(--panel); overflow-x:auto; scrollbar-width:none; gap:5px; flex-wrap:wrap; align-items:center; }
    #filter-bar::-webkit-scrollbar { display:none; }
    #filter-bar.visible { display:flex; }
    .filter-label { font-family:'Fira Code',monospace; font-size:.63rem; color:var(--muted); margin-right:4px; white-space:nowrap; }
    .fmt-chip     { font-family:'Fira Code',monospace; font-size:.63rem; border:1px solid var(--border2); color:var(--muted); padding:2px 9px; border-radius:10px; cursor:pointer; transition:all .15s; white-space:nowrap; background:transparent; user-select:none; }
    .fmt-chip:hover  { border-color:var(--white); color:var(--white); }
    .fmt-chip.active { border-color:var(--red); color:var(--red); background:var(--red-dim); }
    .fmt-chip.all    { border-color:var(--muted); }

    /* ── DELETE CONFIRMATION MODAL ── */
    #modal-ov { position:fixed; inset:0; background:rgba(0,0,0,.7); z-index:9000; display:none; align-items:center; justify-content:center; padding:20px; }
    #modal-ov.on { display:flex; }
    .mbox       { background:var(--panel); border:1px solid var(--red); padding:24px; border-radius:6px; max-width:420px; width:100%; display:flex; flex-direction:column; gap:12px; box-shadow:0 8px 32px rgba(0,0,0,.25); }
    .mbox h3    { font-size:1rem; font-weight:700; color:var(--white); }
    .mbox p     { color:var(--muted); font-size:.82rem; line-height:1.65; }
    .mlist      { max-height:120px; overflow-y:auto; background:var(--bg); border:1px solid var(--border); padding:8px 12px; font-family:'Fira Code',monospace; font-size:.65rem; color:var(--red); scrollbar-width:thin; border-radius:3px; }
    .mlist div  { margin-bottom:3px; word-break:break-all; }
    .minput     { background:var(--bg); border:1px solid var(--border2); color:var(--white); padding:8px 11px; font-family:'Fira Code',monospace; font-size:.85rem; border-radius:4px; width:100%; outline:none; transition:border-color .2s; }
    .minput:focus { border-color:var(--red); }
    .mactions   { display:flex; gap:9px; justify-content:flex-end; }
    .btn-cancel  { background:transparent; border:1px solid var(--border2); color:var(--muted); padding:7px 16px; border-radius:4px; font-family:'Fira Code',monospace; font-size:.78rem; cursor:pointer; transition:all .2s; }
    .btn-cancel:hover  { border-color:var(--muted); color:var(--white); }
    .btn-confirm { background:var(--red); border:1px solid var(--red); color:#fff; padding:7px 16px; border-radius:4px; font-family:'Fira Code',monospace; font-size:.78rem; cursor:pointer; transition:all .2s; }
    .btn-confirm:hover    { opacity:.85; }
    .btn-confirm:disabled { opacity:.3; cursor:not-allowed; }

    /* ── SETTINGS MODAL ── */
    #settings-ov { position:fixed; inset:0; background:rgba(0,0,0,.7); z-index:9000; display:none; align-items:center; justify-content:center; padding:20px; }
    #settings-ov.on { display:flex; }
    .sbox         { background:var(--panel); border:1px solid var(--border2); padding:24px; border-radius:6px; max-width:480px; width:100%; display:flex; flex-direction:column; gap:20px; box-shadow:0 8px 32px rgba(0,0,0,.35); max-height:90vh; overflow-y:auto; }
    .sbox h3      { font-size:1rem; font-weight:700; color:var(--white); display:flex; align-items:center; gap:8px; }
    .sdivider     { border:none; border-top:1px solid var(--border); margin:0; }
    .sfield       { display:flex; flex-direction:column; gap:8px; }
    .sfield > .slabel { font-size:.82rem; font-weight:700; color:var(--white); font-family:'GoogleSans',sans-serif; }
    .sfield .hint { font-family:'Fira Code',monospace; font-size:.62rem; color:var(--dim); line-height:1.6; }
    .cfg-checks   { display:flex; flex-direction:column; gap:0; }
    .cfg-check-row {
      display:flex; align-items:flex-start; gap:10px;
      padding:9px 12px; border-radius:4px; cursor:pointer;
      transition:background .12s; user-select:none;
    }
    .cfg-check-row:hover                     { background:var(--red-dim); }
    .cfg-check-row input[type=checkbox]      { accent-color:var(--red); width:15px; height:15px; flex-shrink:0; margin-top:2px; cursor:pointer; }
    .cfg-check-label  { display:flex; flex-direction:column; gap:2px; }
    .cfg-check-title  { font-size:.82rem; color:var(--white); line-height:1.4; }
    .cfg-check-sub    { font-family:'Fira Code',monospace; font-size:.62rem; color:var(--muted); }
    .sfield input[type=number] { background:var(--bg); border:1px solid var(--border2); color:var(--white); padding:8px 11px; font-family:'Fira Code',monospace; font-size:.8rem; border-radius:4px; width:100%; outline:none; transition:border-color .2s; }
    .sfield input[type=number]:focus { border-color:var(--red); }
    .ssize-row    { display:flex; gap:8px; align-items:stretch; }
    .ssize-row input { flex:1; }
    .cfg-select   { background:var(--bg); border:1px solid var(--border2); color:var(--muted); padding:8px 10px; font-family:'Fira Code',monospace; font-size:.8rem; border-radius:4px; outline:none; cursor:pointer; transition:border-color .2s; }
    .cfg-select:focus { border-color:var(--red); }
    .precision-cards { display:flex; flex-direction:column; gap:8px; }
    .precision-card  { display:flex; align-items:flex-start; gap:12px; border:1px solid var(--border2); border-radius:5px; padding:11px 14px; cursor:pointer; transition:border-color .18s, background .18s; }
    .precision-card:hover    { border-color:var(--muted); }
    .precision-card.selected { border-color:var(--red); background:var(--red-dim); }
    .precision-card input[type=radio] { accent-color:var(--red); flex-shrink:0; margin-top:3px; cursor:pointer; }
    .pc-body  { display:flex; flex-direction:column; gap:3px; }
    .pc-title { font-size:.83rem; font-weight:700; color:var(--white); }
    .pc-title .pc-badge { display:inline-block; background:var(--red); color:#fff; font-size:.57rem; font-family:'Fira Code',monospace; padding:1px 6px; border-radius:8px; margin-left:6px; vertical-align:middle; font-weight:700; }
    .pc-desc  { font-size:.73rem; color:var(--muted); line-height:1.55; }

    /* ── LANGUAGE VISIBILITY ── */
    body.es .en { display:none !important; }
    body.en .es { display:none !important; }

    /* ── CLEAN SLATE SCREEN ── */
    .ok-screen   { display:flex; flex-direction:column; align-items:center; justify-content:center; gap:18px; padding:40px; text-align:center; min-height:100%; }
    .ok-screen h2 { font-size:1.3rem; font-weight:700; }
    .ok-screen p  { color:var(--muted); font-size:.84rem; line-height:1.7; max-width:300px; }

    #mobile-input { display:none; }
    #mobile-feed-btn { display:none; }

    /* ── RESPONSIVE: ≤ 768px ── */
    @media (max-width: 768px) {
      html, body   { overflow:auto; height:auto; }
      .app-body    { height:auto; min-height:calc(100svh - 54px); }
      .panels-row  { flex-direction:column; overflow:visible; height:auto; flex:none; }
      .panel       { width:100% !important; flex:none !important; min-width:unset; overflow:visible; }

      #panel-left {
        height:0; overflow:hidden; border-right:none;
        border-bottom:1px solid var(--border);
        transition:height .3s ease;
      }
      #panel-left.mobile-open        { height:220px; }
      #panel-left.mobile-open #feed  { overflow-y:auto; }

      #panel-mid     { min-height:60svh; border-right:none; border-bottom:1px solid var(--border); }
      #dupes-scroll  { max-height:60svh; overflow-y:auto; }

      #panel-right   { height:auto; border-right:none; border-top:1px solid var(--border); }
      #prev-empty    { min-height:80px; }
      #prev-content  { max-height:50svh; }

      .divider { display:none; }
      nav          { padding:0 12px; gap:4px; }
      .logo        { font-size:.95rem; }
      .nav-folder  { display:none !important; }
      .nav-byline  { display:none; }

      #stats-bar   { flex-wrap:wrap; gap:6px; padding:8px 10px; min-height:auto; }
      .sbar-left   { flex:0 0 100%; justify-content:flex-start; }
      .sbar-center { flex:0 0 100%; }
      .sbar-right  { flex:0 0 100%; flex-wrap:wrap; gap:4px; }

      #home        { padding:24px 20px; min-height:50svh; }

      #mobile-feed-btn {
        display:flex !important; position:fixed; bottom:18px; right:18px; z-index:500;
        width:46px; height:46px; border-radius:50%;
        background:var(--red); border:none; color:#fff; font-size:1.05rem;
        cursor:pointer; align-items:center; justify-content:center;
        box-shadow:0 4px 20px rgba(232,0,45,.45); transition:transform .15s;
      }
      #mobile-feed-btn:active                 { transform:scale(.9); }
      #mobile-feed-btn.feed-visible           { background:var(--panel); color:var(--red); border:1px solid var(--red); }

      .sbox { max-height:85svh; }
    }
  